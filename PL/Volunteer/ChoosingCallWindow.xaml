<Window x:Class="PL.Volunteer.ChoosingCallWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PL.Volunteer"
        mc:Ignorable="d"
        Title="ChoosingCallWindow" 
        Height="700" 
        Width="1000"
         Icon="{StaticResource WindowIcon}"
        Style="{StaticResource BackGroundPic}"
        Loaded="Window_Loaded"
        Closed="Window_Closed"
        DataContext="{Binding RelativeSource={RelativeSource Mode=Self}}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Filter and Sort Section -->
        <Grid Grid.Row="0" Margin="5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Filter Section -->
            <StackPanel Grid.Column="0" Margin="5">
                <Label Content="Filter By:" HorizontalAlignment="Left"/>
                <ComboBox ItemsSource="{Binding Source={StaticResource CallTypeFilterOptionsWithoutNoCallTypeOptionCollectionKey}}"
                            SelectedValue="{Binding Path=SelectedFilterOption, Mode=TwoWay, Converter={StaticResource ConvertCallTypeEnumToCallTypeFilterOptionsWithoutNoCallTypeOptionEnumKey}}" 
                            SelectionChanged="OnOpenCallsListFilterOrSortOptionChanged" 
                            HorizontalAlignment="Stretch"/>
            </StackPanel>

            <!-- Sort Section -->
            <StackPanel Grid.Column="1" Margin="5">
                <Label Content="Sort By:" HorizontalAlignment="Left"/>
                <ComboBox ItemsSource="{Binding Source={StaticResource OpenCallInListSortOptionsKey}}"
                            SelectedValue="{Binding Path=SelectedSortOption, Mode=TwoWay}"  
                            SelectionChanged="OnOpenCallsListFilterOrSortOptionChanged" 
                            HorizontalAlignment="Stretch"/>
            </StackPanel>
        </Grid>

        <!-- ListView for Open Calls -->
        <ListView Margin="5" Grid.Row="1" 
          ItemsSource="{Binding OpenCallsList}" 
          SelectedItem="{Binding SelectedOpenCall}">
            <ListView.View>
                <GridView>
                    <GridViewColumn DisplayMemberBinding="{Binding Id}" Header="Id" Width="Auto"/>
                    <GridViewColumn DisplayMemberBinding="{Binding CType}" Header="Call Type" Width="Auto"/>
                    <GridViewColumn DisplayMemberBinding="{Binding FullAddress}" Header="Full Address" Width="Auto"/>
                    <GridViewColumn DisplayMemberBinding="{Binding Opening}" Header="Opening Time" Width="Auto"/>
                    <GridViewColumn DisplayMemberBinding="{Binding MaxTime}" Header="Max Time" Width="Auto"/>
                    <GridViewColumn DisplayMemberBinding="{Binding Distance}" Header="Distance" Width="Auto"/>

                    <!-- New Column for the 'Choose' button -->
                    <GridViewColumn Header="Actions" Width="Auto">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="Choose" Click="btnChooseCall_Click" Width="75"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>

        <!-- Description Display Section -->
        <Grid Grid.Row="2" Margin="5">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Row for the title -->
                <RowDefinition Height="*"/>
                <!-- Row for the description -->
            </Grid.RowDefinitions>

            <!-- Title for the description -->
            <Label Grid.Row="0" Content="Selected Call Description:" FontWeight="Bold" Margin="0,0,0,5"/>

            <!-- Description inside a Border -->
            <Border Grid.Row="1" BorderBrush="Gray" BorderThickness="1" Padding="10">
                <TextBlock Name="DescriptionTextBlock" Text="{Binding SelectedOpenCall.Description}" TextWrapping="Wrap"/>
            </Border>
        </Grid>
        <Grid Grid.Row="3" Margin="5">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Address Row -->
                <RowDefinition Height="Auto"/>
                <!-- Max Distance Row -->
                <RowDefinition Height="Auto"/>
                <!-- Active Row -->
                <RowDefinition Height="Auto"/>
                <!-- Update button Row -->
            </Grid.RowDefinitions>


            <!-- Address Section -->
            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                <Label Content="Address:" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBox Text="{Binding CurrentVolunteer.FullAddress, Mode=TwoWay}" Width="250" VerticalAlignment="Center" Margin="0,0,10,0"/>
            </StackPanel>

            <!-- Max Distance Section -->
            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                <Label Content="Max Distance:" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBox Text="{Binding CurrentVolunteer.Distance, Mode=TwoWay}" Width="100" VerticalAlignment="Center" Margin="0,0,10,0"/>
            </StackPanel>

            <!-- Active Section -->
            <StackPanel Grid.Row="2" Orientation="Horizontal">
                <Label Content="Active:" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <CheckBox IsChecked="{Binding CurrentVolunteer.Active, Mode=TwoWay}" VerticalAlignment="Center"/>
            </StackPanel>
            
            <!-- Update Button Section -->
            <Button Content="Update details" Click="btnUpdateDetails_Click" Grid.Row="3" Width="110" HorizontalAlignment="left" VerticalAlignment="Center" Margin="10,10,10,10"/>
            
        </Grid>
    </Grid>
</Window>
